# Инвестиционные скрипты

Этот проект содержит набор скриптов для анализа инвестиционных данных.

## Инструменты

### 1. Фильтр дивидендных компаний

Скрипт для фильтрации компаний из списка U.S. Dividend Champions по определенным критериям.

#### Критерии фильтрации

Скрипт отбирает компании, которые соответствуют следующим критериям:

1. Выплачивают дивиденды не менее 15 лет
2. Текущая дивидендная доходность не менее 2,5%
3. Выплачивают дивиденды не реже 4 раз в год
4. Рост дивидендов за последний год не менее 2%
5. Увеличивали дивиденды в последний год (проверка по дате ex-div)
6. Выплатили на дивиденды не более 70% от прибыли
7. Рыночная капитализация не менее 2 млрд долларов

#### Использование

```bash
# Запуск фильтра дивидендных компаний
npm run filter-dividends
```

Результаты фильтрации будут сохранены в файл `Filtered-Dividend-Champions-YYYY-MM-DD.xlsx` в корневой директории проекта.

### 2. Скрапер Yahoo Finance

Скрипт для сбора данных о компаниях с сайта Yahoo Finance.

#### Функциональность

- Сбор данных о рыночной капитализации, мультипликаторах и других финансовых показателях
- Обработка данных и сохранение в Excel-файл
- Поддержка списка тикеров из файла tickers.txt

#### Использование

```bash
# Запуск скрапера Yahoo Finance
npm run scrape-yahoo
```

Результаты будут сохранены в файл `valuation_data_YYYY-MM-DD.xlsx` в корневой директории проекта.

## Требования

- Node.js (версия 14 или выше)
- TypeScript
- Для фильтра дивидендных компаний: файл `U.S.DividendChampions-LIVE.xlsx` в корневой директории проекта
- Для скрапера Yahoo Finance: файл `tickers.txt` со списком тикеров в корневой директории проекта

## Установка

```bash
# Установка зависимостей
npm install

# Установка Playwright (для скрапера Yahoo Finance)
npx playwright install chromium
```

## Настройка параметров

### Фильтр дивидендных компаний

Вы можете изменить параметры фильтрации, отредактировав следующие константы в файле `dividend-filter.ts`:

```typescript
const MIN_YEARS = 15 // Минимальное количество лет выплаты дивидендов
const MIN_YIELD = 2.5 // Минимальная дивидендная доходность (%)
const MIN_PAYOUTS_PER_YEAR = 4 // Минимальное количество выплат в год
const MIN_DGR_1Y = 2 // Минимальный рост дивидендов за 1 год (%)
const MAX_PAYOUT_RATIO = 70 // Максимальный коэффициент выплат (%)
const MIN_MARKET_CAP = 2e9 // Минимальная рыночная капитализация (2 млрд)
```

### Скрапер Yahoo Finance

Вы можете настроить селекторы и таймауты в файле `constants.ts`.
